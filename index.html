<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>FocusMed</title>



<meta name="theme-color" content="#080b12">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="FocusMed">
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
<style>
:root {
  --bg:      #080b12;
  --s1:      #0f1520;
  --s2:      #151e30;
  --s3:      #1c2840;
  --border:  #232f45;
  --nutri:   #34d399;
  --nutri-d: rgba(52,211,153,0.10);
  --nutri-g: rgba(52,211,153,0.25);
  --ecg:     #38bdf8;
  --ecg-d:   rgba(56,189,248,0.10);
  --ecg-g:   rgba(56,189,248,0.25);
  --pause:   #a78bfa;
  --pause-d: rgba(167,139,250,0.12);
  --text:    #e2eaf8;
  --muted:   #4e6080;
  --muted2:  #7a8faa;
  --radius:  16px;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:'DM Sans',sans-serif;
  color:var(--text);
  background:var(--bg);
  min-height:100vh;
  /* subtle diagonal lines texture */
  background-image:
    repeating-linear-gradient(
      -45deg,
      transparent,
      transparent 40px,
      rgba(255,255,255,0.012) 40px,
      rgba(255,255,255,0.012) 41px
    );
}

/* â”€â”€ LAYOUT â”€â”€ */
.app{
  width:min(100%,440px);
  margin:0 auto;
  padding:0 14px calc(84px + env(safe-area-inset-bottom));
}

/* â”€â”€ HEADER â”€â”€ */
.header{
  position:sticky;
  top:0;z-index:10;
  padding:16px 2px 12px;
  background:linear-gradient(180deg,rgba(8,11,18,.96) 70%,transparent);
  backdrop-filter:blur(12px);
  display:flex;justify-content:space-between;align-items:flex-start;
}
.header-title{
  font-family:'DM Serif Display',serif;
  font-size:26px;
  letter-spacing:-0.02em;
  line-height:1.1;
}
.header-sub{font-size:12px;color:var(--muted2);margin-top:3px}
.streak-badge{
  font-family:'DM Mono',monospace;
  font-size:11px;
  background:var(--s2);
  border:1px solid var(--border);
  padding:5px 11px;
  border-radius:20px;
  color:var(--muted2);
  white-space:nowrap;
  flex-shrink:0;
  margin-top:4px;
}

/* â”€â”€ VIEWS â”€â”€ */
.view{display:none;gap:12px;flex-direction:column}
.view.active{display:flex}

/* â”€â”€ CARD â”€â”€ */
.card{
  background:var(--s1);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
}
.card-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:0.1em;
  color:var(--muted);
  margin-bottom:14px;
}

/* â”€â”€ SUBJECT PILLS â”€â”€ */
.subject-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.subject-card{
  background:var(--s2);
  border:1.5px solid var(--border);
  border-radius:14px;
  padding:14px;
  cursor:pointer;
  transition:all .2s;
}
.subject-card.sel-nutri{border-color:var(--nutri);background:var(--nutri-d)}
.subject-card.sel-ecg  {border-color:var(--ecg);  background:var(--ecg-d)}
.subj-icon{font-size:20px;margin-bottom:6px}
.subj-name{font-size:13px;font-weight:600}
.subj-goal{font-size:11px;color:var(--muted2);margin-top:2px}
.subj-done{
  font-family:'DM Mono',monospace;
  font-size:21px;
  margin-top:8px;
}
.subj-done small{font-size:11px;color:var(--muted2)}

/* â”€â”€ RING TIMER â”€â”€ */
.timer-wrap{
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:6px 0 14px;
}
.ring-outer{position:relative;width:192px;height:192px;margin-bottom:14px}
.ring-outer svg{transform:rotate(-90deg)}
.ring-track{fill:none;stroke:var(--border);stroke-width:9}
.ring-fill{
  fill:none;stroke-width:9;stroke-linecap:round;
  stroke-dasharray:565;stroke-dashoffset:565;
  transition:stroke-dashoffset .9s linear,stroke .35s;
}
.timer-center{
  position:absolute;inset:0;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;
}
.timer-digits{
  font-family:'DM Mono',monospace;
  font-size:38px;
  font-weight:500;
  letter-spacing:-0.02em;
  line-height:1;
}
.timer-phase{
  font-size:10px;
  text-transform:uppercase;
  letter-spacing:0.12em;
  color:var(--muted2);
  margin-top:5px;
}

/* live pulse when running */
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
.timer-digits.live{animation:pulse 2s ease-in-out infinite}

/* â”€â”€ POMO DOTS â”€â”€ */
.pomo-row{display:flex;gap:5px;margin-bottom:16px}
.pomo-dot{
  width:9px;height:9px;border-radius:50%;
  background:var(--border);
  transition:background .3s,transform .2s;
}
.pomo-dot.done-nutri{background:var(--nutri);transform:scale(1.15)}
.pomo-dot.done-ecg  {background:var(--ecg);  transform:scale(1.15)}
.pomo-dot.cur       {border:2px solid var(--muted2);background:transparent}

/* â”€â”€ CONTROLS â”€â”€ */
.ctrl-row{display:flex;gap:10px;align-items:center;width:100%}
.btn-icon{
  width:46px;height:46px;flex-shrink:0;
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:11px;
  color:var(--muted2);
  font-size:17px;
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all .15s;
}
.btn-icon:hover{border-color:var(--text);color:var(--text)}
.btn-main{
  flex:1;
  padding:13px;
  border:none;
  border-radius:12px;
  font-family:'DM Sans',sans-serif;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  transition:all .15s;
  letter-spacing:-0.01em;
}
.btn-main:active{transform:scale(0.97)}
.btn-nutri{background:var(--nutri);color:#060d15}
.btn-ecg  {background:var(--ecg);  color:#060d15}
.btn-pause{background:var(--pause);color:#060d15}
.btn-neutral{background:var(--s2);color:var(--text);border:1px solid var(--border)}

/* â”€â”€ PRESETS â”€â”€ */
.preset-row{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:7px;
  margin-bottom:14px;
}

/* custom timer modal */
.modal-backdrop{
  position:fixed;inset:0;
  background:rgba(0,0,0,.7);
  backdrop-filter:blur(6px);
  z-index:200;
  display:flex;align-items:flex-end;justify-content:center;
  opacity:0;pointer-events:none;
  transition:opacity .25s;
}
.modal-backdrop.open{opacity:1;pointer-events:all}
.modal-sheet{
  background:var(--s1);
  border:1px solid var(--border);
  border-radius:22px 22px 0 0;
  padding:20px 20px 36px;
  width:min(100%,440px);
  transform:translateY(100%);
  transition:transform .3s ease;
}
.modal-backdrop.open .modal-sheet{transform:translateY(0)}
.modal-title{
  font-family:'DM Serif Display',serif;
  font-size:20px;
  margin-bottom:18px;
  text-align:center;
}
.modal-fields{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:18px}
.modal-field label{
  display:block;font-size:11px;
  text-transform:uppercase;letter-spacing:.08em;
  color:var(--muted2);margin-bottom:6px;
}
.modal-field input{
  width:100%;
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:10px;
  color:var(--text);
  font-family:'DM Mono',monospace;
  font-size:22px;
  text-align:center;
  padding:12px;
  outline:none;
}
.modal-field input:focus{border-color:var(--nutri)}
.modal-btns{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.btn-modal-cancel{
  background:var(--s2);border:1px solid var(--border);
  border-radius:11px;color:var(--muted2);
  font-family:'DM Sans',sans-serif;font-size:14px;font-weight:600;
  padding:13px;cursor:pointer;
}
.btn-modal-ok{
  background:var(--nutri);color:#060d15;
  border:none;border-radius:11px;
  font-family:'DM Sans',sans-serif;font-size:14px;font-weight:700;
  padding:13px;cursor:pointer;
}
.preset-btn{
  background:var(--s2);
  border:1.5px solid var(--border);
  border-radius:10px;
  color:var(--muted2);
  padding:9px 6px;
  font-family:'DM Sans',sans-serif;
  font-size:11px;
  font-weight:600;
  cursor:pointer;
  text-align:center;
  transition:all .2s;
}
.preset-btn .pb-name{font-size:12px;color:var(--text)}
.preset-btn.active-nutri{border-color:var(--nutri);background:var(--nutri-d);color:var(--nutri)}
.preset-btn.active-nutri .pb-name{color:var(--nutri)}
.preset-btn.active-ecg  {border-color:var(--ecg);  background:var(--ecg-d);  color:var(--ecg)}
.preset-btn.active-ecg   .pb-name{color:var(--ecg)}

/* â”€â”€ PROGRESS BARS â”€â”€ */
.prog-wrap{margin-bottom:12px}
.prog-wrap:last-child{margin-bottom:0}
.prog-head{display:flex;justify-content:space-between;font-size:12px;color:var(--muted2);margin-bottom:6px}
.prog-head strong{font-family:'DM Mono',monospace;font-size:12px;color:var(--text)}
.prog-track{height:6px;background:var(--s3);border-radius:3px;overflow:hidden}
.prog-fill{height:100%;border-radius:3px;transition:width .4s ease}
.pf-nutri{background:linear-gradient(90deg,var(--nutri),rgba(52,211,153,.6))}
.pf-ecg  {background:linear-gradient(90deg,var(--ecg),  rgba(56,189,248,.6))}

/* â”€â”€ DAILY PLAN â”€â”€ */
.plan-item{
  display:flex;
  gap:12px;
  padding:10px 0;
  border-bottom:1px solid var(--border);
}
.plan-item:last-child{border-bottom:none}
.plan-time{
  font-family:'DM Mono',monospace;
  font-size:11px;
  color:var(--muted2);
  width:52px;flex-shrink:0;
  padding-top:2px;
}
.plan-body{flex:1}
.plan-label{font-size:13px;font-weight:500}
.plan-detail{font-size:11px;color:var(--muted2);margin-top:2px}
.plan-pill{
  display:inline-block;
  font-size:10px;
  font-weight:600;
  padding:2px 8px;
  border-radius:20px;
  margin-top:4px;
}
.pp-nutri{background:var(--nutri-d);color:var(--nutri)}
.pp-ecg  {background:var(--ecg-d);  color:var(--ecg)}
.pp-pause{background:var(--pause-d);color:var(--pause)}

/* â”€â”€ TASKS â”€â”€ */
.task-input-row{display:grid;grid-template-columns:1fr auto;gap:8px;margin-bottom:10px}
.task-input-row input,
.task-input-row select{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:10px;
  color:var(--text);
  font-family:'DM Sans',sans-serif;
  font-size:13px;
  padding:10px 12px;
  min-height:44px;
  outline:none;
}
.task-input-row input:focus{border-color:var(--muted2)}
.task-input-row select{width:90px;cursor:pointer}
.btn-add{
  width:100%;
  padding:11px;
  background:var(--nutri);
  color:#060d15;
  border:none;
  border-radius:10px;
  font-family:'DM Sans',sans-serif;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  transition:opacity .15s;
  margin-bottom:10px;
}
.btn-add:active{opacity:.8}
.task-item{
  display:flex;
  align-items:center;
  gap:10px;
  padding:11px 12px;
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:11px;
  margin-bottom:7px;
}
.task-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.task-body{flex:1}
.task-text{font-size:13px;font-weight:500}
.task-meta{font-size:11px;color:var(--muted2);margin-top:2px}
.task-chip{
  font-size:10px;font-weight:700;
  padding:2px 8px;border-radius:20px;flex-shrink:0;
}
.chip-nutri{background:var(--nutri-d);color:var(--nutri)}
.chip-ecg  {background:var(--ecg-d);  color:var(--ecg)}
.task-del{
  background:none;border:none;
  color:var(--muted);font-size:16px;
  cursor:pointer;padding:4px;
  transition:color .15s;
}
.task-del:hover{color:var(--text)}
.empty-state{
  text-align:center;
  padding:30px;
  color:var(--muted);
  font-size:13px;
}

/* â”€â”€ STATS PAGE â”€â”€ */
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}
.stat-box{
  background:var(--s2);
  border-radius:12px;
  padding:14px;
}
.stat-val{font-family:'DM Mono',monospace;font-size:24px;font-weight:500}
.stat-label{font-size:10px;text-transform:uppercase;letter-spacing:0.08em;color:var(--muted2);margin-top:4px}

/* session log */
.session-item{
  display:flex;align-items:center;gap:10px;
  padding:10px 12px;
  background:var(--s2);
  border-radius:10px;
  margin-bottom:7px;
}
.sess-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.sess-body{flex:1}
.sess-subj{font-size:13px;font-weight:500}
.sess-detail{font-size:11px;color:var(--muted2);margin-top:1px}
.sess-dur{font-family:'DM Mono',monospace;font-size:12px;color:var(--muted2)}

/* â”€â”€ NAV â”€â”€ */
nav{
  position:fixed;
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  width:min(calc(100% - 20px),420px);
  background:rgba(10,14,22,.92);
  border:1px solid var(--border);
  border-radius:18px;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:4px;
  padding:7px;
  backdrop-filter:blur(16px);
  z-index:100;
}
nav button{
  background:none;
  border:none;
  border-radius:11px;
  color:var(--muted);
  font-family:'DM Sans',sans-serif;
  font-size:10px;
  font-weight:500;
  letter-spacing:0.05em;
  text-transform:uppercase;
  padding:8px 4px;
  cursor:pointer;
  display:flex;flex-direction:column;align-items:center;gap:3px;
  transition:all .15s;
}
nav button svg{width:18px;height:18px}
nav button.active{color:var(--text);background:var(--s2)}

/* â”€â”€ TOAST â”€â”€ */
.toast{
  position:fixed;top:16px;left:50%;
  transform:translateX(-50%) translateY(-80px);
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:12px;
  padding:11px 20px;
  font-size:13px;font-weight:500;
  z-index:999;
  transition:transform .3s ease;
  white-space:nowrap;
  box-shadow:0 8px 32px rgba(0,0,0,.5);
}
.toast.show{transform:translateX(-50%) translateY(0)}

/* â”€â”€ DIVIDER â”€â”€ */
.divider{
  display:flex;align-items:center;gap:8px;
  margin:6px 0 12px;
  font-size:10px;text-transform:uppercase;letter-spacing:0.1em;color:var(--muted);
}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border)}

/* â”€â”€ DANGER BTN â”€â”€ */
.btn-danger{
  background:none;
  border:1px solid var(--border);
  border-radius:9px;
  color:var(--muted2);
  font-family:'DM Sans',sans-serif;
  font-size:13px;
  padding:10px 20px;
  cursor:pointer;
  transition:all .15s;
}
.btn-danger:hover{border-color:#ef4444;color:#ef4444}


/* â”€â”€ Deep Mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
body.deep-mode .header,
body.deep-mode nav,
body.deep-mode .subject-row,
body.deep-mode .preset-row,
body.deep-mode .card-title,
body.deep-mode #card-progress,
body.deep-mode #card-plan,
body.deep-mode #card-tasks,
body.deep-mode #view-plan,
body.deep-mode #view-tasks,
body.deep-mode #view-stats {
  display:none !important;
}
body.deep-mode #view-timer{display:flex !important}
body.deep-mode #card-timer{padding-top:22px}
body.deep-mode .deep-minimal{
  display:flex !important;
}
.deep-minimal{
  display:none;
  margin-top:10px;
  width:100%;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}
.deep-pill{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:999px;
  padding:8px 12px;
  font-size:11px;
  color:var(--muted2);
  cursor:pointer;
}
.deep-pill strong{color:var(--text); font-family:'DM Mono',monospace; font-size:11px}
.deep-pill.on{border-color:var(--pause); color:var(--pause)}
/* soft enter/exit */
body{transition:filter .25s ease}
body.deep-mode{filter:saturate(1.05)}

/* â”€â”€ Session popup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal2-backdrop{
  position:fixed; inset:0;
  background:rgba(0,0,0,.72);
  backdrop-filter:blur(8px);
  z-index:300;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  opacity:0; pointer-events:none;
  transition:opacity .25s ease;
}
.modal2-backdrop.open{opacity:1; pointer-events:all}
.modal2-sheet{
  width:min(100%,440px);
  background:var(--s1);
  border:1px solid var(--border);
  border-radius:22px 22px 0 0;
  padding:18px 18px 28px;
  transform:translateY(100%);
  transition:transform .3s ease;
}
.modal2-backdrop.open .modal2-sheet{transform:translateY(0)}
.modal2-h{
  font-family:'DM Serif Display',serif;
  font-size:19px;
  text-align:center;
  margin-bottom:10px;
}
.modal2-sub{
  text-align:center;
  color:var(--muted2);
  font-size:12px;
  margin-bottom:14px;
}
.tag-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-bottom:12px;
}
.tag-btn{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px 10px;
  color:var(--text);
  font-size:13px;
  cursor:pointer;
}
.tag-btn.sel{border-color:var(--pause); box-shadow:0 0 0 3px rgba(167,139,250,.14)}
.energy-row{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:10px 0 16px;
}
.star{
  width:42px; height:42px;
  display:grid; place-items:center;
  border-radius:12px;
  background:var(--s2);
  border:1px solid var(--border);
  cursor:pointer;
  font-size:18px;
  color:var(--muted2);
}
.star.sel{border-color:var(--nutri); color:var(--text)}
.modal2-actions{display:grid; grid-template-columns:1fr 1fr; gap:10px}
.btn-ghost{
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px;
  color:var(--muted2);
  font-weight:600;
  cursor:pointer;
}
.btn-solid{
  background:var(--nutri);
  border:none;
  border-radius:12px;
  padding:12px;
  color:#060d15;
  font-weight:800;
  cursor:pointer;
}

/* â”€â”€ Weekly chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.week-wrap{margin-top:10px}
.week-canvas{
  width:100%;
  height:120px;
  background:var(--s2);
  border:1px solid var(--border);
  border-radius:12px;
}
.small-note{color:var(--muted2); font-size:11px; margin-top:8px; text-align:center}

/* â”€â”€ Confetti â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
#confetti{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:500;
}

</style>
<link rel="icon" type="image/png" href="data:image/png;base64,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">
<link rel="apple-touch-icon" href="data:image/png;base64,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">
<script>
(function(){
  var manifest = {"name": "FocusMed", "short_name": "FocusMed", "start_url": "./index.html", "scope": "./", "display": "standalone", "background_color": "#080b12", "theme_color": "#080b12", "orientation": "portrait-primary", "icons": [{"src": "data:image/png;base64,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", "sizes": "192x192", "type": "image/png", "purpose": "any"}, {"src": "data:image/png;base64,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", "sizes": "192x192", "type": "image/png", "purpose": "maskable"}, {"src": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAYyklEQVR4nO3dy69dV33A8XVv/IhtYhsH2lSEUPIQUkl4JsJCagfmWaoWCOqk/0HVYQdVJIZIbudVValSp5U6IGEAKaGyqkqFtBDKw2ViCklVlVCS4kfs+BHsDozxtX0fZ5+z9nr9Pp9ZFJ9HnHvW77vX3vuetbsPHLmWAIBQ1mu/AQCgPAEAAAEJAAAISAAAQEACAAACEgAAEJAAAICABAAABCQAACAgAQAAAQkAAAhIAABAQAIAAAISAAAQkAAAgIAEAAAEJAAAICABAAABCQAACEgAAEBAAgAAAhIAABCQAACAgAQAAAQkAAAgIAEAAAEJAAAISAAAQEACAAACEgAAEJAAAICABAAABCQAACAgAQAAAQkAAAhIAABAQAIAAAISAAAQkAAAgIAEAAAEJAAAICABAAABCQAACEgAAEBAAgAAAhIAABCQAACAgAQAAAQkAAAgIAEAAAEJAAAISAAAQEACAAACEgAAEJAAAICABAAABCQAACAgAQAAAQkAAAhIAABAQLtqvwFgdY8+f7zo6508+lTR1wPyW7v7wJFrtd8EsLnSgz03oQDtEgBQWe9DflniAOoSAFBI1EE/lTCAMgQAzMCwz0sUQH4CADIw8MsSBLA6AQBLMPDbIghgOgEACzL0+yAGYDECALZg4I9BEMDmBABsYOiPTQzATQKA8Az9mMQA0QkAQjL02UgMEJEAIAxDn0WIAaIQAAzP4GcZQoDRCQCGZOiTkxhgRAKAoRj8zEkIMBIBwBAMfkoSAoxAANAtQ/9Wp46V+ft45ITht5EYoFcCgO5EG/ylBntu0UJBCNAbAUA3Rh78vQ75ZY0cB0KAXggAmjfa4I827Bc1WhQIAVonAGjWCIPfsF/NCFEgBGiVAKA5PQ9+A39ePQeBEKA1AoBm9Dj4Dfy6egwCIUArBABN6Gn4G/pt6ikGRAAtEABU1cvgN/T70ksMCAFqEgBU0cPgN/TH0EMMCAFqEAAU1frgN/TH1noMCAFKEgAU0+rwN/RjajUGRAClCABm1+LgN/TZqMUYEALMTQAwG4Of3ggBIhEAzKK14W/wM0VrISACmIMAIKuWBr+hTw4txYAQICcBQDatDH+Dnzm0EgIigFwEACsz+IlECDAKAcBKWhj+Bj81tBACIoBVCACWVnv4G/y0oHYIiACWJQCYzOCHOwkBeiMAmKTm8Df46UHNEBABTCEAWFit4W/w06NaISACWJQAYEcGPyxPCNCq9dpvgLYZ/rCaWj/Lta/VoX12ANhSjQXE4GdkNXYD7ASwFQHAHQx+mJcQoAVOAXALwx/mV+Nn3ikBbmcHgF8pvUAY/FB+N8BOADfYASClZPhDLaU/C3YCuMEOAEUXBIMftlZyN8BOAAIgMEf90B6nBChFAATlqB/aZjeAubkGICDDH9pX8rPjuoCYBEAwhj/0QwQwJ6cAAin1ATf4Ib9SpwScDojDDkAQhj/0rdRny05AHAIgAMMfxiACyMkpgMGV+CAb/FBeiVMCTgeMzQ7AwAx/GFeJz56dgLEJgEEZ/jA+EcAqBMCADH+IQwSwLNcADGbuD6rBD+2a+7oA1wSMxQ7AQAx/iG3uz6idgLEIgEEY/kBKIoDFCYABGP7ARiKARQiAzhn+wGZEADsRAB0z/IHtiAC2IwA6ZfgDixABbEUAdMjwB6YQAWxGAHALwx/G5LPN7QRAZ+YsbQsEjG3Oz7hdgP4IgI4Y/sCqRAA3CIBOGP5ALiKAlARAFwx/Iijx/fbcJALwZUCNM/xp1SMnnlr6Z2irYe9nsrw5w8uXB7VtV+03QB0WWnLIPTxWiQqWc+rYcbsvQTkF0LC5jv4tsMBGc60JTgW0TQA0yvAHShIB8QiABhn+QA0iIBYBEIThT05znjN2Proua0UcAqAxc5SyDzQwxRxrhl2A9giAhhj+QCtEwPgEQCN8MIAIrHXtEAADc/RPr1wH0AZryNgEQANs/QOtcipgXAKgMsMfaJ0IGJMAqMjwB3ohAsYjAIBJSp2fdx0AzEsAVOLoH+iNXYCxCIAKDH+gVyJgHAJgAIY/UJI1ZwwCoDClC4tzHUAc1sbyBEBBtv6BUTgV0D8B0DHDH6jJGtQ3AVBI7rL1wQNakHstsgtQjgAAmuY6AJiHACjA0T+jMIzZjF2APgmAmRn+QAQioD8CAAACEgAzcvQPeTj10Ae7AH0RAJ0w/IEeWKv6IQBmolwBVmctnY8A6ICiBnpizeqDAJhBzmL1QYLrXAfQl5xrl12AeQiAzPygMioDmJqsrfkJgIY5+gd6Zg1rmwDISKECzMcam5cAaJRyhjs5DdEfa1m7BEAmLvwD2JwLAtskAAAgIAGQgaN/KMdpgD7ZBWiPAACAgATAihz9AyzGLkBbBACwI9vuMB4BsAJH/1CHIOmXXYB2CAAACEgALMnRP8By7AK0QQAAQEACoDJH/7Ac1wH0zdpXnwBYgi0ngHZYk5cjACpSwEBk1sC6BMBEShOgPdbm6QRAJcqXXrR8rr3l98ZirIX1CIAJFCZAu6zR0wiAChQvwE3WxDoEAAAEJAAWZGsJ2uQ6ADayVi9OABRmqwvgTtbG8gTAAhQlQD+s2YsRAAUpXICtWSPLEgDQkNbOZ7f2frbSy/uElgiAHeTaSlK27OTGEDPMiCzXWuk0wM4EADTg9qEvAoC5CQCobKthLwKAOQmAbdj+Z247DfkRI2Cuz8OIf1dROQ1QhgCAShYdWAYbMAcBABVMHepT/rxgABaxq/YbaJXtf1pjsBPJqWPHs/zMP/r88XTyqM/OZuwAQGEGuesAoAUCAArqaUD19F6B6QTAJmz/M4eSA9XwZgTuBpiXAIACDOTrSkSxv2tYjACAmRlIm7NDBnUJgJlY3EjJ8IdVWUvnIwBu41wRuRj+0A5r+50EAMzA8F+M2wGhHgEwA1tWsRk+kJc1dR4CYANbRKyqpeG/yntp6b8DcrHG30oAQCaGJtATAZCZraqYDP+dbfXZcB0Ai7C25icAACAgAfBLzg2xLEea0A9r/U0CAFZg+AO9EgAZOUcVi+Gfj+sAWIQ1Ni8BAEswWIDeCYDknBDT9DT8e3qvUIo1/zoBABNEGKgR/hsBAZCNc1PjMxjn5ToAFmGtzUcAwAIMkdVYtKE9AgB2YPgDIwofAC4GYTuGP4zJ2i8AYEulh79tctcBQEkCIAML93hGGv6GH6Ox5uYhAKAyixlQgwCA29Q8Yq4dA3YLIA4BABuMtPXfK9cBQBm7ar+BmlwFalGsKcrwb+m/08/7nVr6/1Pao88fTyePxv2ZsAOwosgfHpbn5wZW4zO0OgEAhVm4gBYIACio1vDvbetbJMH8BAAUYqgBLREAUMCU4S8UgBIEAMzMQAdaFDYA3AJICT0N/9auE+jp745+RZ4FYQMgBwsU2/HzAfPyGVuNAIAZWJiu8/cA7RIAkFmrQ6+1LX6grtC/Chho26ljx7cMl9tDS+DANAIAtrHdANrqz9d43dG1uqsCPXMKAHaw6PAxpObh7xXmIQBgATsNIUMK6I0AgAVtNeQNf6BHAgAmuH3YjzL8XW8A8YQMgMi/+YnV3Rj6owz/ufj7oRdRZ0LIAMjB4hZbr///Hekzml4/iy0QAAAQkACARjmyAebkFwEFZ8gwCj/LMI0dAAAISAAAQEACAIJzZwDEJAAgGAMfSEkAADNwQR60TwBAwwxSYC4CAAACEgAAEJAAAICABAAABCQAICC3AgICAAITAhCXAIDGuRUQmIMAALISLNAHAQAAAQkAAAhIAABAQAIAgnIHAMQmAAAgIAEAHXBlPZCbAACAgAQAkI2dCuiHAFiSC6gA6rMWLy9kAJw86gcGgOuizoSQAQAA0QkAAAhIAEAnXGAH5CQAACAgAQAAAQkAAAhIAABZuEYB+iIAACAgAbACv4EKoB5r8GrCBkDU3/wEwE2RZ0HYAIAeOc8O5CIAACAgAQAAAQkAAAhIAAArc20C9EcArMhtKADlWXtXFzoAIt/+ARBd9BkQOgCgR7bbgRwEAAAEJAAAICABkIGLUQDKsebmIQAAIKDwARD9KlCAiKz9AgBYkbsSoE8CADpk6AKrEgCZuCgFYH7W2nwEAAAEJACSi0EAIrHmXycAACAgAZCRc1MA87HG5iUAACAgAfBLzgnRmxZuBWzhPcAU1vqbBAAABCQAMnOOCiA/a2t+AgAAAhIAGzg3BDAua/ytBMAMbFUB5GNNnYcAAICABMBtbBEBjMfaficBMBNbVpTgPnxGZy2djwAAliI+oG8CAAACEgCbyHWuyNYVwPJyraHO/29OAABAQAIAAAISAFtwGgCgHtv/8xMA0DlX4wPLEAAAEJAA2IbTAADl2f4vQwAAkzntAP3bVfsNQA1rd62nh7/2Z7XfxiQv/tFfpSsvn6n9NlJKKT305T9NP/7Dv0xXL1wq9pqHP/dEeuuffDTrc/787/81vfLXJ7I+J/TCDsAOnAaAO63v25MO/u57yr3gWkqHP/PBcq9HNbb/yxEAwFIOf+aDKa2Vea0DRx9Ou9/25jIvBkEIgILsAjCXGufkd7/tzenAhx4u8lqHn3y8yOtQlzWyLAGwAFtJsLnDn51/W37PA/em/R945+yvwzis2YsRAIUpXEay//EH05633zvraxx+8vFipxqox9pYngBYkKKETayldGjGXYD1A3vTPR9/bLbnZzzW6sUJAGAlBz/+WFrfv3eW5z70qfem9bt3z/LcEJ0AqMBWFyNZ378nHfzkDEfpa2vpkFv/QrAm1iEAJrC1BJub45bAAx9+OO3+jcN5n5ShWaOnEQCVKF5yq/nreXfffyQdeOKhrM95+Mknsj4fbbIW1iMAJlKYsLmc9+rv+c23pP3vf0e252N81ubpfBdARY+ceMqXqnTs5S98KZ078YPab6MZ+594MO25/0i6/N//t/JzOfqPwdF/XXYAlqA0YROZbglcv+fudPBj787whojCmrwcAVCZAmYkBz/xnrS+f89Kz3HoU+9La3vd+jc6a199AgDIZn3/nnTwEyt8S+D6Wjr06Q/ke0PAlgTAknJuOSlhRnLos8vfEvimDz+Sdt93KO8bojk51zzb/8sTAEBWe+4/kvY/8eBSjz38uWkX/11+6dX0i7OvL/VaEJ0AWIFdAFrTyl0ly9wSuPfBt6Z9731g0mNOP/Otya9DXY7+2yEAgOwOPPFQ2n3/kUmPmXrr39Xzl9K5r35/0mOAmwTAiuwCwCbWfvnrgRd018F96Z6PTLv17+yz301XL16Z+s6oyNF/WwQAMIuDn3wsre9b7JbAg7/3vrS2d8LvJbt2LZ1++oUl3xmQkgDIwi4AYVxb/I+u79+bDn5igW8JXF9Lhyfe+nf++R+mKz85Pekx1OXovz0CAFjY+X/7z0l/fpFbAt/02+9Ku37t4KTnPf1FF//BqgRAJnYBGN2pY8cnD949b7837X98+1sCp94xcPmlV9OFF16c9BjqcvTfJl8G1ChfFNS++z7/6XTf5z89++u88jf/lH7+d99Y+M+fOnZ8toi88K0fpcv/9Wra88C9Cz/m8Gc/mC5880eb/ru9D/962vfY2ye9h9NPO/rviQOadtkByEiZMrxrKZ15ZtrFdwc+9HDa/bY3b/rvph79X33tYjr3nFv/orLG5iUAGqacadHZr34/XT1/afEHbHFL4F2H9qV7jv3WpNc+8+z33PrXEWtY2wRAZgqVVpw6djydOnY8/fBjf7HS87z6t/98yz9fff1yOvsP35v0HAc/+Z47bgk89PvvT2t7pt36N3X3gXFYW/MTADNwQSC15b5+5PbnO/30CyldW/yewPUDe9M9H3/0V/+8dtd6OvQHE2/9+4Zb/3riwr/2CYAOiABac+V/fp7OPz/tlsDDn3n8V7cEvul33pV2veWeSY93618/rFl9EAAzUayMbvItge+4N+3/wDtTSsvc+vdKuvDtFyc9hjFYS+cjADqhqGnNhRd+nC6/9Oqkxxx+8vG095H70t3vvn/S4xz998Na1Q8BMKPc5eqDRWum3pN/4OhD6a1//JFJj7n62sV07msnJz2GOnKvUY7+5yUAgKWde+776eprFxd/wNpa2ve+Bya9xpmv+NY/mIMAmJldAEZ29eKVdObZabcETnLtWjrzpW/P9/xk4+i/PwKgABHAyM48M+2WwCnOf92tfz0w/PvkuwBgSS9/4Uvp3Ikf1H4b1V35yel0/hs/TAc+/Ej25z79xW9mf07gOjsAhdgFYGRzXKV/+cVX0oV/fyn785KXo/9+CYCOiQBaceHbL6bLL76S9Tl961/7rEF9EwAFzVG2PoC0IufAvnruYjr7nFv/WjbH2uPovywBUJgfcEZ19rmT6eq5CbcEbuPMs99N1y659S8Sa2N5AmAAdgFowbVLV9KZZ7+b4Yl861/rrDljEAAVOBXAqE4//UJKV1e7JfC1fzmVrrx8JtM7Ijdb/+MQAJWIAEb0xk/PpNe+fmql5/B7/9tl+I9FAABZrTLAL//4Z+n177j1D0oQABXZBWBEr3/npXTpRz9b6rFu/WuXo//xCIDKRAAjOrPEIL967mI6+7X/mOHdsCrDf0wCoAEigNGc/ceT6RfnXp/0mDNf+Y5b/xpk+I9LAAxMBFDLtUtvpLNfnnBL4NVr6fQzvvWvNdaQsQmARihiRnP6mcVvCXzt66fSGz91618E1rp2+DbAhpw8+lR69PnjWZ/zkRNPpVPH8j4nLOKN/z2bTn30z2u/DZZk6398dgAa43oAoDbDPwYBEIQIABZhrYhDADRorlL2wQa2M9ca4ei/TQKgUSIAKMnwj0cANEwEACUY/jEJgKBEAJCStSAyAdC4OQvaBx9im3MNcPTfPgHQAREA5Gb4IwA6IQKAXAx/UhIAXREBwKoMf24QAJ0RAcCyDH82Wrv7wJHFvq2DZuT+voDb+e4AGM/cgS8A+mMHoENzf9DsBMBYDH82IwA6JQKARRj+bEUAdEwEANsx/NmOAOicCAA2Y/izEwEwABEAbGT4swgBMAgRAKRk+LM4ATAQEQCxGf5M4fcADGju3xOQkt8VAC0pEeeG/3jsAAyoxAfVbgC0wfBnWQJgUCIAxmf4swoBMDARAOMy/FmVawACKHFNQEquC4ASSkW34T8+OwABlPog2w2AeRn+5CQAghAB0DfDn9ycAgim1OmAlJwSgBxKRrXhH4sdgGBKfsDtBsBqDH/mJAACEgHQPsOfuTkFEFjJ0wEpOSUAiygdzYZ/XAIA1wVAIxz1U5IAIKVkNwBqctRPDa4BIKVUfkFwbQBcZ/hTix0AblF6JyAluwHEVCOCDX82sgPALWosEHYDiMbwpwV2ANiS3QDIy+CnJQKAbdWIgJSEAGOptctl+LMdpwDYVq0FxGkBRmH40yo7ACzMbgAszuCndQKASWpFQEpCgD7U3L0y/JlCADBZzQhISQjQptqnrQx/phIALE0IgMFPvwQAK6kdASkJAeqoPfhTMvxZjQBgZS1EQEpCgDJaGPwpGf6sTgCQjRBgZAY/oxEAZNVKBKQkBMijlcGfkuFPXgKAWbQUAimJAaZpaeinZPAzDwHAbFqLgJSEANtrbfCnZPgzHwHA7IQArTP4iUgAUEyLIZCSGIiqxaGfksFPOQKAolqNgBvEwNhaHfo3GP6UJACoovUQSEkMjKL1oZ+SwU8dAoCqegiBlMRAb3oY+ikZ/NQlAGhCLyGQkhhoVS9DPyWDnzYIAJrRUwTcIAbq6mno32D40woBQHN6DIEbBMG8ehz4Nxj8tEYA0KyeQ+AGQbCangf+DQY/rRIANG+EENhIFGxuhGG/kcFP6wQA3RgtBDaKFgWjDfuNDH56IQDozsghsJle42DkIb8Zg5/eCAC6FS0EdlIqFKIN9p0Y/PRKADAEMUBJhj4jEAAMRQgwJ4OfkQgAhiQEyMngZ0QCgOGJAZZh6DM6AUAYQoBFGPxEIQAISQywkaFPRAKA8MRATIY+0QkA2EAMjM3Qh5sEAGxBDIzB0IfNCQBYkCDog4EPixEAsAQx0BZDH6YTAJCBICjLwIfVCQCYgSDIy8CH/AQAFCIKFmPYQxkCACqLGgYGPdQlAKBhvceBIQ/tEgAwgNKhYLBD/wQAAAS0XvsNAADlCQAACEgAAEBAAgAAAhIAABCQAACAgAQAAAQkAAAgIAEAAAEJAAAISAAAQEACAAACEgAAEJAAAICABAAABCQAACAgAQAAAQkAAAhIAABAQAIAAAISAAAQkAAAgIAEAAAEJAAAICABAAABCQAACEgAAEBAAgAAAhIAABCQAACAgAQAAAQkAAAgIAEAAAEJAAAISAAAQEACAAACEgAAEJAAAICABAAABCQAACAgAQAAAQkAAAhIAABAQAIAAAISAAAQkAAAgIAEAAAEJAAAICABAAABCQAACEgAAEBAAgAAAhIAABCQAACAgAQAAAQkAAAgIAEAAAEJAAAISAAAQEACAAAC+n9/YiwJ5yxaDAAAAABJRU5ErkJggg==", "sizes": "512x512", "type": "image/png", "purpose": "any"}, {"src": "data:image/png;base64,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", "sizes": "512x512", "type": "image/png", "purpose": "maskable"}]};
  var blob = new Blob([JSON.stringify(manifest)], {type:'application/json'});
  var url = URL.createObjectURL(blob);
  var link = document.createElement('link');
  link.rel = 'manifest';
  link.href = url;
  document.head.appendChild(link);
})();
</script>
</head>
<body>

<div class="toast" id="toast"></div>

<div class="app">

  <!-- HEADER -->
  <header class="header">
    <div>
      <div class="header-title">FocusMed</div>
      <div class="header-sub" id="hdr-date"></div>
    </div>
    <div class="streak-badge" id="streak-badge">ðŸ”¥ 0 giorni</div>
  </header>

  <!-- â•â•â•â•â•â•â•â•â•â• VIEW: TIMER â•â•â•â•â•â•â•â•â•â• -->
  <div class="view active" id="view-timer">

    <!-- Subject selector -->
    <div class="subject-row">
      <div class="subject-card" id="sc-nutri" onclick="selectSubject('nutri')">
        <div class="subj-icon">ðŸ¥—</div>
        <div class="subj-name">Nutrizione</div>
        <div class="subj-goal">Target: <span id="nutri-goal-lbl">3h 30m</span></div>
        <div class="subj-done" id="nutri-done-lbl">0:00 <small>/ <span id="nutri-tgt">3h 30m</span></small></div>
      </div>
      <div class="subject-card" id="sc-ecg" onclick="selectSubject('ecg')">
        <div class="subj-icon">ðŸ’“</div>
        <div class="subj-name">ECG</div>
        <div class="subj-goal">Target: <span id="ecg-goal-lbl">45m</span></div>
        <div class="subj-done" id="ecg-done-lbl">0:00 <small>/ <span id="ecg-tgt">45m</span></small></div>
      </div>
    </div>

    <!-- Progress bars -->
    <div class="card">
      <div class="prog-wrap">
        <div class="prog-head"><span>ðŸ¥— Nutrizione</span><strong id="nutri-pct">0%</strong></div>
        <div class="prog-track"><div class="prog-fill pf-nutri" id="nutri-bar" style="width:0%"></div></div>
      </div>
      <div class="prog-wrap">
        <div class="prog-head"><span>ðŸ’“ ECG</span><strong id="ecg-pct">0%</strong></div>
        <div class="prog-track"><div class="prog-fill pf-ecg" id="ecg-bar" style="width:0%"></div></div>
      </div>
    </div>

    <!-- Timer card -->
    <div class="card">
      <!-- preset selector -->
      <div class="preset-row">
        <div class="preset-btn" data-preset="nutri45" onclick="selectPreset('nutri45',this)">
          <div class="pb-name">45/10</div>
          <div>Master</div>
        </div>
        <div class="preset-btn" data-preset="ecg30" onclick="selectPreset('ecg30',this)">
          <div class="pb-name">30/5</div>
          <div>ECG</div>
        </div>
        <div class="preset-btn" data-preset="deep60" onclick="selectPreset('deep60',this)">
          <div class="pb-name">60/10</div>
          <div>Deep</div>
        </div>
        <div class="preset-btn" id="btn-custom-preset" onclick="openModal()">
          <div class="pb-name">â±</div>
          <div>Custom</div>
        </div>
      </div>

      <!-- ring -->
      <div class="timer-wrap">
        <div class="pomo-row" id="pomo-dots"></div>

        <div class="ring-outer">
          <svg viewBox="0 0 192 192" width="192" height="192">
            <circle class="ring-track" cx="96" cy="96" r="84"/>
            <circle class="ring-fill" id="ring" cx="96" cy="96" r="84"/>
          </svg>
          <div class="timer-center">
            <div class="timer-digits" id="timer-digits">45:00</div>
            <div class="timer-phase"  id="timer-phase">Seleziona materia</div>
          </div>
        </div>

        <div class="ctrl-row">
          <div class="btn-icon" onclick="resetTimer()" title="Reset">â†º</div>
          <button class="btn-main btn-neutral" id="btn-start" onclick="toggleTimer()">Avvia</button>
          <div class="btn-icon" onclick="skipPhase()" title="Salta">â­</div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• VIEW: PIANO â•â•â•â•â•â•â•â•â•â• -->
  <div class="view" id="view-piano">
    <div class="card">
      <div class="card-title">Piano del giorno</div>
      <div id="plan-list"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• VIEW: TASK â•â•â•â•â•â•â•â•â•â• -->
  <div class="view" id="view-task">
    <div class="card">
      <div class="card-title">Task rapidi</div>
      <div class="task-input-row">
        <input id="task-input" type="text" placeholder="Es. ECG: blocco AV tipo 2â€¦">
        <select id="task-type">
          <option value="nutri">ðŸ¥—</option>
          <option value="ecg">ðŸ’“</option>
        </select>
      </div>
      <button class="btn-add" onclick="addTask()">Aggiungi</button>
      <div id="task-list"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• VIEW: STATS â•â•â•â•â•â•â•â•â•â• -->
  <div class="view" id="view-stats">
    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-val" id="st-total">0:00</div>
        <div class="stat-label">Totale oggi</div>
      </div>
      <div class="stat-box">
        <div class="stat-val" id="st-pomos">0</div>
        <div class="stat-label">Sessioni</div>
      </div>
      <div class="stat-box">
        <div class="stat-val" id="st-nutri">0:00</div>
        <div class="stat-label">Nutrizione</div>
      </div>
      <div class="stat-box">
        <div class="stat-val" id="st-ecg">0:00</div>
        <div class="stat-label">ECG</div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">Sessioni di oggi</div>
      <div id="session-log"><div class="empty-state">Nessuna sessione ancora</div></div>
    </div>

    <div style="text-align:center">
      <button class="btn-danger" onclick="resetDay()">Azzera giornata</button>
    </div>
  </div>

<!-- CUSTOM TIMER MODAL -->
<div class="modal-backdrop" id="custom-modal" onclick="closeModal(event)">
  <div class="modal-sheet">
    <div class="modal-title">Timer personalizzato</div>
    <div class="modal-fields">
      <div class="modal-field">
        <label>Minuti</label>
        <input type="number" id="custom-mins" value="30" min="1" max="240" placeholder="30">
      </div>
      <div class="modal-field">
        <label>Pausa (min)</label>
        <input type="number" id="custom-break" value="5" min="1" max="60" placeholder="5">
      </div>
    </div>
    <div class="modal-btns">
      <button class="btn-modal-cancel" onclick="closeModalBtn()">Annulla</button>
      <button class="btn-modal-ok" onclick="applyCustom()">Avvia</button>
    </div>
  </div>
</div>

</div><!-- /app -->

<!-- SESSION TAG + ENERGY MODAL -->
<div class="modal2-backdrop" id="session-modal" onclick="closeSessionModal(event)">
  <div class="modal2-sheet">
    <div class="modal2-h">Check-out sessione</div>
    <div class="modal2-sub">Tagga il tipo di studio e la tua energia mentale.</div>

    <div class="divider">tipo</div>
    <div class="tag-grid" id="tag-grid"></div>

    <div class="divider">energia</div>
    <div class="energy-row" id="energy-row"></div>

    <div class="modal2-actions">
      <button class="btn-ghost" onclick="skipSessionTag()">Salta</button>
      <button class="btn-solid" onclick="saveSessionTag()">Salva</button>
    </div>
  </div>
</div>

<!-- GOAL LOCK MODAL -->
<div class="modal2-backdrop" id="lock-modal" onclick="closeLockModal(event)">
  <div class="modal2-sheet">
    <div class="modal2-h">Session Goal Lock</div>
    <div class="modal2-sub">Imposta un target (es. 180 min Nutrizione) e blocca reset finchÃ© non lo raggiungi.</div>

    <div class="modal-fields" style="grid-template-columns:1fr; margin-top:6px">
      <div class="modal-field">
        <label>Target Nutrizione (min)</label>
        <input type="number" id="lock-target" value="180" min="30" max="600">
      </div>
    </div>

    <div class="modal2-actions">
      <button class="btn-ghost" onclick="disableGoalLock()">Disattiva</button>
      <button class="btn-solid" onclick="enableGoalLock()">Attiva</button>
    </div>
  </div>
</div>

<canvas id="confetti"></canvas>
 -->

<!-- NAV -->
<nav>
  <button class="active" data-view="timer" onclick="goView('timer',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    Timer
  </button>
  <button data-view="piano" onclick="goView('piano',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
    Piano
  </button>
  <button data-view="task" onclick="goView('task',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
    Task
  </button>
  <button data-view="stats" onclick="goView('stats',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
    Stats
  </button>
</nav>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS & CONFIG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PRESETS = {
  nutri45: { study:45*60, breakS:10*60, breakL:20*60, subject:'nutri', label:'Master 45/10' },
  ecg30:   { study:30*60, breakS:5*60,  breakL:10*60, subject:'ecg',   label:'ECG 30/5' },
  deep60:  { study:60*60, breakS:10*60, breakL:20*60, subject:'nutri', label:'Deep 60/10' },
};

const GOALS = { nutri: 210, ecg: 45 }; // minutes - editable

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let S = {
  // timer
  preset:   'nutri45',
  subject:  null,        // 'nutri' | 'ecg'
  phase:    'focus',     // 'focus' | 'break-s' | 'break-l'
  running:  false,
  remaining: 45*60,
  totalSecs: 45*60,

  // progress (seconds for live accuracy)
  nutriSecs: 0,
  ecgSecs:   0,

  // cycles
  sessionsCompleted: 0,

  // log
  sessions: [],
  tasks:    [],

  // streak
  streak: 0,
};

let ticker = null;
let tickerStartedAt = null;   // Date.now() quando avviato
let tickerBaseRemaining = 0;  // secondi rimasti al momento dell'avvio
const CIRC = Math.PI * 2 * 84; // â‰ˆ 527.8

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PERSISTENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const KEY = 'focusmed_v3';

function save() {
  // day snapshot for streak + weekly stats
  const today = new Date().toDateString();
  const payload = {
    date: today,
    // progress
    nutriSecs: S.nutriSecs,
    ecgSecs:   S.ecgSecs,
    sessions:  S.sessions,
    tasks:     S.tasks,
    streak:    S.streak,
    sessionsCompleted: S.sessionsCompleted,

    // runtime (ripristino timer)
    preset:   S.preset,
    subject:  S.subject,
    phase:    S.phase,
    remaining: S.remaining,
    totalSecs: S.totalSecs,
    running:  S.running,
    tickerStartedAt,
    tickerBaseRemaining,

    // deep + lock
    deepEnabled: !!S.deepEnabled,
    goalLock: S.goalLock || null,
  };
  localStorage.setItem(KEY, JSON.stringify(payload));

  // history (last 16 days) for chart
  try {
    const HK = KEY + '_history';
    const hist = JSON.parse(localStorage.getItem(HK) || '{}');
    hist[today] = {
      nutriSecs: S.nutriSecs,
      ecgSecs:   S.ecgSecs,
      sessions:  (S.sessions||[]).length,
    };
    const days = Object.keys(hist).sort((a,b)=> new Date(a) - new Date(b));
    while (days.length > 16) { delete hist[days.shift()]; }
    localStorage.setItem(HK, JSON.stringify(hist));
  } catch(e){}
}

function load() {
  try {
    const d = JSON.parse(localStorage.getItem(KEY)||'{}');
    const today = new Date().toDateString();
    if (d.date === today) {
      S.nutriSecs = d.nutriSecs || 0;
      S.ecgSecs   = d.ecgSecs   || 0;
      S.sessions  = d.sessions  || [];
      S.tasks     = d.tasks     || [];
      S.streak    = d.streak    || 0;
      S.sessionsCompleted = d.sessionsCompleted || 0;

      // runtime restore
      S.preset   = d.preset || S.preset;
      S.subject  = d.subject ?? S.subject;
      S.phase    = d.phase || S.phase;
      S.remaining = typeof d.remaining === 'number' ? d.remaining : S.remaining;
      S.totalSecs = typeof d.totalSecs === 'number' ? d.totalSecs : S.totalSecs;
      S.running  = !!d.running;
      tickerStartedAt = d.tickerStartedAt || null;
      tickerBaseRemaining = d.tickerBaseRemaining || 0;

      S.deepEnabled = !!d.deepEnabled;
      S.goalLock = d.goalLock || null;
    } else {
      // new day: check streak from yesterday
      const yesterday = new Date(); yesterday.setDate(yesterday.getDate()-1);
      const wasYesterday = d.date === yesterday.toDateString();
      const metGoal = (d.nutriSecs||0) >= GOALS.nutri * 60;
      S.streak = (wasYesterday && metGoal) ? (d.streak||0)+1 : 0;
      save();
    }
  } catch(e){}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SUBJECT SELECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function selectSubject(sub) {
  if (S.running) { toast('Ferma il timer prima âœ‹'); return; }
  S.subject = sub;
  S.phase = 'focus';

  document.getElementById('sc-nutri').className = 'subject-card' + (sub==='nutri'?' sel-nutri':'');
  document.getElementById('sc-ecg').className   = 'subject-card' + (sub==='ecg'  ?' sel-ecg':'');

  updateBtnColor();
  updatePhaseLabel();
  updateRing();
}

function selectPreset(name, el) {
  if (S.running) { toast('Ferma il timer prima âœ‹'); return; }
  S.preset = name;
  const p = PRESETS[name];

  // auto-select subject
  S.subject = p.subject;
  document.getElementById('sc-nutri').className = 'subject-card' + (p.subject==='nutri'?' sel-nutri':'');
  document.getElementById('sc-ecg').className   = 'subject-card' + (p.subject==='ecg'  ?' sel-ecg':'');

  // update preset buttons
  document.querySelectorAll('.preset-btn').forEach(b => {
    b.className = 'preset-btn';
    if (b.dataset.preset === name) {
      b.classList.add(p.subject==='nutri'?'active-nutri':'active-ecg');
    }
  });

  S.phase = 'focus';
  S.remaining = p.study;
  S.totalSecs = p.study;

  updateBtnColor();
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIMER CORE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleTimer() {
  if (!S.subject) { toast('Seleziona una materia prima! ðŸ‘†'); return; }
  S.running = !S.running;

  if (S.running) {
    tickerStartedAt = Date.now();
    tickerBaseRemaining = S.remaining;
    lastHapticMark = 0;
    enterDeepModeIfNeeded();
    ticker = setInterval(tick, 500); // ogni 500ms per recuperare subito dopo sblocco
    document.getElementById('timer-digits').classList.add('live');
    document.getElementById('btn-start').textContent = 'Pausa';
    save();
  } else {
    clearInterval(ticker);
    document.getElementById('timer-digits').classList.remove('live');
    document.getElementById('btn-start').textContent = 'Riprendi';
    exitDeepMode();
    save();
  }
}

function tick() {
  // Calcola il tempo reale trascorso dal timestamp (funziona anche con schermo bloccato)
  const elapsed = Math.floor((Date.now() - tickerStartedAt) / 1000);
  const newRemaining = Math.max(0, tickerBaseRemaining - elapsed);

  // Credita i secondi di studio trascorsi dall'ultimo tick
  if (S.phase === 'focus') {
    const delta = S.remaining - newRemaining;
    if (delta > 0) {
      if (S.subject === 'nutri') S.nutriSecs += delta;
      else                        S.ecgSecs   += delta;
      updateProgressUI();
    }
  }

  S.remaining = newRemaining;
  updateTimerDisplay();
  updateRing();
  handleHaptics();
  maybeConfetti();
  goalLockReminderTick();

  if (S.remaining <= 0) phaseEnd();
}

function phaseEnd() {
  clearInterval(ticker);
  S.running = false;
  document.getElementById('timer-digits').classList.remove('live');
  playSound();

  if (S.phase === 'focus') {
    S.sessionsCompleted++;
    const p = PRESETS[S.preset];
    // log session
    S.sessions.push({
      subject:  S.subject,
      duration: Math.round(p.study/60),
      time:     now(),
      type:     'complete',
    });
    openSessionModal(S.sessions.length - 1);
    buildPomodoDots();
    renderSessionLog();
    renderStats();

    // choose break
    const isLong = S.sessionsCompleted % 3 === 0;
    S.phase = isLong ? 'break-l' : 'break-s';
    S.totalSecs = isLong ? p.breakL : p.breakS;
    const bm = Math.round(S.totalSecs/60);
    toast(isLong ? `ðŸŽ‰ Pausa lunga! ${bm} min meritati` : `âœ… Sessione! Pausa ${bm}min â˜•`);

    document.getElementById('btn-start').textContent = 'Avvia pausa';
    document.getElementById('btn-start').className = 'btn-main btn-pause';
  } else {
    // break done
    const p = PRESETS[S.preset];
    S.phase = 'focus';
    S.totalSecs = p.study;
    toast('ðŸ’ª Pausa finita â€” riparti!');
    updateBtnColor();
    document.getElementById('btn-start').textContent = 'Avvia';
  }

  S.remaining = S.totalSecs;
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();
  save();
}

function resetTimer() {
  if (goalLockActiveAndUnmet()) { toast('ðŸ”’ Goal Lock: reset timer bloccato'); softVibrate(15); return; }
  if (S.running) { clearInterval(ticker); S.running = false; }
  document.getElementById('timer-digits').classList.remove('live');
  tickerStartedAt = null; tickerBaseRemaining = 0;
  S.phase = 'focus';
  const p = PRESETS[S.preset];
  S.remaining = p.study;
  S.totalSecs = p.study;
  updateBtnColor();
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();
  document.getElementById('btn-start').textContent = 'Avvia';
}

function skipPhase() {
  if (S.running) { clearInterval(ticker); S.running = false; }
  document.getElementById('timer-digits').classList.remove('live');

  if (S.phase === 'focus') {
    // log partial (min 1 min)
    const elapsed = Math.floor((S.totalSecs - S.remaining)/60);
    if (elapsed >= 1) {
      if (S.subject === 'nutri') S.nutriSecs += elapsed*60;
      else                        S.ecgSecs   += elapsed*60;
      S.sessions.push({ subject: S.subject, duration: elapsed, time: now(), type: 'partial' });
      openSessionModal(S.sessions.length - 1);
      S.sessionsCompleted++;
      buildPomodoDots();
      renderSessionLog();
      renderStats();
      updateProgressUI();
      save();
    }
    const isLong = S.sessionsCompleted % 3 === 0;
    S.phase = isLong ? 'break-l' : 'break-s';
    S.totalSecs = isLong ? PRESETS[S.preset].breakL : PRESETS[S.preset].breakS;
    document.getElementById('btn-start').textContent = 'Avvia pausa';
    document.getElementById('btn-start').className = 'btn-main btn-pause';
  } else {
    S.phase = 'focus';
    S.totalSecs = PRESETS[S.preset].study;
    updateBtnColor();
    document.getElementById('btn-start').textContent = 'Avvia';
  }

  S.remaining = S.totalSecs;
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIMER UI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function updateTimerDisplay() {
  const m = String(Math.floor(S.remaining/60)).padStart(2,'0');
  const s = String(S.remaining%60).padStart(2,'0');
  document.getElementById('timer-digits').textContent = `${m}:${s}`;
}

function updateRing() {
  const pct = S.remaining / S.totalSecs;
  const offset = CIRC * pct;
  const ring = document.getElementById('ring');
  ring.style.strokeDasharray  = CIRC;
  ring.style.strokeDashoffset = CIRC - offset;

  let color = 'var(--nutri)';
  if (S.phase === 'break-s' || S.phase === 'break-l') color = 'var(--pause)';
  else if (S.subject === 'ecg') color = 'var(--ecg)';
  ring.style.stroke = color;
}

function updatePhaseLabel() {
  const map = {
    'focus':   S.subject ? `Focus ${S.subject==='nutri'?'Nutrizione':'ECG'}` : 'Seleziona materia',
    'break-s': 'Pausa breve â˜•',
    'break-l': 'Pausa lunga ðŸ§˜',
  };
  document.getElementById('timer-phase').textContent = map[S.phase]||'';
}

function updateBtnColor() {
  const btn = document.getElementById('btn-start');
  btn.className = 'btn-main ' + (S.subject==='ecg' ? 'btn-ecg' : S.subject==='nutri' ? 'btn-nutri' : 'btn-neutral');
}

function buildPomodoDots() {
  const row = document.getElementById('pomo-dots');
  const total = 8;
  row.innerHTML = '';
  for (let i = 0; i < total; i++) {
    const d = document.createElement('div');
    d.className = 'pomo-dot';
    if (i < S.sessionsCompleted % total) {
      d.classList.add(S.subject==='ecg' ? 'done-ecg' : 'done-nutri');
    } else if (i === S.sessionsCompleted % total && S.phase==='break-s') {
      d.classList.add('cur');
    }
    row.appendChild(d);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS UI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function updateProgressUI() {
  const nm = S.nutriSecs/60, em = S.ecgSecs/60;
  const ng = GOALS.nutri, eg = GOALS.ecg;

  const npct = Math.min(100, Math.round(nm/ng*100));
  const epct = Math.min(100, Math.round(em/eg*100));

  document.getElementById('nutri-bar').style.width = npct+'%';
  document.getElementById('ecg-bar').style.width   = epct+'%';
  document.getElementById('nutri-pct').textContent = npct+'%';
  document.getElementById('ecg-pct').textContent   = epct+'%';

  document.getElementById('nutri-done-lbl').innerHTML = formatSecs(S.nutriSecs,true)+' <small>/ <span id="nutri-tgt">'+fmtGoal(ng)+'</span></small>';
  document.getElementById('ecg-done-lbl').innerHTML   = formatSecs(S.ecgSecs,  true)+' <small>/ <span id="ecg-tgt">'+fmtGoal(eg)+'</span></small>';
}

function renderGoalLabels() {
  document.getElementById('nutri-goal-lbl').textContent = fmtGoal(GOALS.nutri);
  document.getElementById('ecg-goal-lbl').textContent   = fmtGoal(GOALS.ecg);
  document.getElementById('nutri-tgt').textContent      = fmtGoal(GOALS.nutri);
  document.getElementById('ecg-tgt').textContent        = fmtGoal(GOALS.ecg);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DAILY PLAN (dynamic)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildPlan() {
  const plan = [];
  let cur = 9*60; // start 09:00

  const p = PRESETS['nutri45'];
  const focusMins = p.study/60;
  const nutriGoal = GOALS.nutri;
  const ecgGoal   = GOALS.ecg;

  // Split nutrizione: first half morning, second half afternoon
  const half1 = Math.ceil(nutriGoal/2);
  const half2 = nutriGoal - half1;

  function addBlock(type, label, detail, dur) {
    plan.push({ type, label, detail, dur, start: cur });
    cur += dur;
  }

  // MORNING: Nutrizione session 1
  const np1 = Math.ceil(half1/focusMins);
  for (let i = 0; i < np1; i++) {
    addBlock('nutri', `Focus Nutrizione #${i+1}`, `Pomodoro ${i+1}/${np1}`, focusMins);
    if (i < np1-1) {
      const bl = (i+1)%3===0;
      addBlock('pause', bl?'Pausa lunga':'Pausa breve', bl?'Muoviti, idratati':'Acqua, respira', bl?20:10);
    }
  }

  // Pranzo
  addBlock('pause','Pranzo & Riposo','Stacca completamente',60);

  // ECG
  const ep = Math.ceil(ecgGoal/30); // 30min blocks
  for (let i = 0; i < ep; i++) {
    const d = Math.min(30, ecgGoal-i*30);
    addBlock('ecg', `Focus ECG #${i+1}`, `Interpretazione tracciati â€” blocco ${i+1}`, d);
    if (i < ep-1) addBlock('pause','Pausa breve','5 min',5);
  }

  // AFTERNOON: Nutrizione session 2
  addBlock('pause','Mini pausa','Prepara il secondo blocco',15);
  const np2 = Math.ceil(half2/focusMins);
  for (let i = 0; i < np2; i++) {
    addBlock('nutri', `Focus Nutrizione #${np1+i+1}`, `Pomodoro ${i+1}/${np2}`, focusMins);
    if (i < np2-1) {
      const bl = (i+1)%3===0;
      addBlock('pause', bl?'Pausa lunga':'Pausa breve', '',bl?20:10);
    }
  }

  const container = document.getElementById('plan-list');
  container.innerHTML = plan.map(b => {
    const h = Math.floor(b.start/60), m = b.start%60;
    const t = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
    const pillCls = b.type==='nutri'?'pp-nutri':b.type==='ecg'?'pp-ecg':'pp-pause';
    const pillTxt = b.type==='nutri'?'Nutrizione':b.type==='ecg'?'ECG':'Pausa';
    return `
      <div class="plan-item">
        <div class="plan-time">${t}</div>
        <div class="plan-body">
          <div class="plan-label">${b.label}</div>
          <div class="plan-detail">${b.detail} Â· ${b.dur}min</div>
          <span class="plan-pill ${pillCls}">${pillTxt}</span>
        </div>
      </div>`;
  }).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TASKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function addTask() {
  const input = document.getElementById('task-input');
  const text  = input.value.trim();
  if (!text) { toast('Scrivi qualcosa prima ðŸ“'); return; }
  const type = document.getElementById('task-type').value;
  S.tasks.unshift({ text, type, time: now() });
  input.value = '';
  save();
  renderTasks();
}

function removeTask(idx) {
  S.tasks.splice(idx,1);
  save();
  renderTasks();
}

function renderTasks() {
  const container = document.getElementById('task-list');
  if (!S.tasks.length) {
    container.innerHTML = '<div class="empty-state">Nessun task â€” aggiungine uno sopra</div>';
    return;
  }
  container.innerHTML = S.tasks.map((t,i) => `
    <div class="task-item">
      <div class="task-dot" style="background:${t.type==='nutri'?'var(--nutri)':'var(--ecg)'}"></div>
      <div class="task-body">
        <div class="task-text">${t.text}</div>
        <div class="task-meta">${t.time}</div>
      </div>
      <span class="task-chip ${t.type==='nutri'?'chip-nutri':'chip-ecg'}">${t.type==='nutri'?'ðŸ¥—':'ðŸ’“'}</span>
      <button class="task-del" onclick="removeTask(${i})">âœ“</button>
    </div>
  `).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderStats() {
  const total = S.nutriSecs + S.ecgSecs;
  document.getElementById('st-total').textContent = formatSecs(total,true);
  document.getElementById('st-pomos').textContent = S.sessionsCompleted;
  document.getElementById('st-nutri').textContent = formatSecs(S.nutriSecs,true);
  document.getElementById('st-ecg').textContent   = formatSecs(S.ecgSecs,  true);

  renderWeeklyChart();
  renderQualityBox();
}

function renderSessionLog() {
  const container = document.getElementById('session-log');
  if (!S.sessions.length) {
    container.innerHTML = '<div class="empty-state">Nessuna sessione ancora</div>';
    return;
  }
  container.innerHTML = [...S.sessions].reverse().map(s => `
    <div class="session-item">
      <div class="sess-dot" style="background:${s.subject==='nutri'?'var(--nutri)':'var(--ecg)'}"></div>
      <div class="sess-body">
        <div class="sess-subj">${s.subject==='nutri'?'ðŸ¥— Nutrizione':'ðŸ’“ ECG'}</div>
        <div class="sess-detail">${s.time} Â· ${s.type==='partial'?'parziale':'completa'}</div>
      </div>
      <div class="sess-dur">${s.duration}min</div>
    </div>
  `).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goView(name, btn) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById('view-'+name).classList.add('active');
  btn.classList.add('active');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function formatSecs(secs, short=false) {
  secs = Math.max(0, Math.floor(secs));
  const m = Math.floor(secs/60);
  const h = Math.floor(m/60);
  const rm = m%60;
  if (short) return h ? `${h}:${String(rm).padStart(2,'0')}` : `${m}m`;
  return h ? `${h}h ${rm}m` : `${m}m`;
}

function fmtGoal(mins) {
  if (mins<60) return mins+'m';
  const h=Math.floor(mins/60), m=mins%60;
  return m ? `${h}h ${m}m` : `${h}h`;
}

function now() {
  return new Date().toLocaleTimeString('it-IT',{hour:'2-digit',minute:'2-digit'});
}

let toastTimer;
function toast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.classList.remove('show'), 3000);
}

function playSound() {
  // Vibrazione pattern sveglia: 3 impulsi forti
  if (navigator.vibrate) {
    navigator.vibrate([400, 150, 400, 150, 400]);
  }
  // Suono di backup (per chi ha vibrazione disattivata)
  try {
    const ctx = new(window.AudioContext||window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const g   = ctx.createGain();
    osc.connect(g); g.connect(ctx.destination);
    osc.frequency.setValueAtTime(880, ctx.currentTime);
    osc.frequency.setValueAtTime(660, ctx.currentTime+.12);
    osc.frequency.setValueAtTime(880, ctx.currentTime+.24);
    g.gain.setValueAtTime(.25, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(.001, ctx.currentTime+.6);
    osc.start(ctx.currentTime);
    osc.stop(ctx.currentTime+.6);
  } catch(e){}
}

function resetDay() {
  if (goalLockActiveAndUnmet()) { toast('ðŸ”’ Goal Lock attivo: reset bloccato'); softVibrate(20); return; }
  if (!confirm('Sei sicuro? Tutti i dati di oggi verranno cancellati.')) return;
  S.nutriSecs = 0; S.ecgSecs = 0;
  S.sessions = []; S.sessionsCompleted = 0;
  clearInterval(ticker); S.running = false;
  S.phase = 'focus'; S.subject = null;
  document.getElementById('sc-nutri').className = 'subject-card';
  document.getElementById('sc-ecg').className   = 'subject-card';
  document.getElementById('timer-digits').classList.remove('live');
  updateBtnColor();
  updateProgressUI(); updatePhaseLabel(); renderStats(); renderSessionLog(); buildPomodoDots();
  resetTimer(); save();
  toast('Dati azzerati âœ“');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CUSTOM TIMER MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openModal() {
  if (S.running) { toast('Ferma il timer prima âœ‹'); return; }
  document.getElementById('custom-modal').classList.add('open');
  setTimeout(() => document.getElementById('custom-mins').focus(), 350);
}

function closeModalBtn() {
  document.getElementById('custom-modal').classList.remove('open');
}

function closeModal(e) {
  // close only if clicking backdrop, not sheet
  if (e.target === document.getElementById('custom-modal')) closeModalBtn();
}

function applyCustom() {
  const mins  = Math.max(1, Math.min(240, parseInt(document.getElementById('custom-mins').value) || 30));
  const brk   = Math.max(1, Math.min(60,  parseInt(document.getElementById('custom-break').value) || 5));

  // Inject a temporary custom preset
  PRESETS['custom'] = {
    study:  mins * 60,
    breakS: brk  * 60,
    breakL: Math.max(brk * 2, 10) * 60,
    subject: S.subject || 'nutri',
    label:  `Custom ${mins}/${brk}`
  };

  closeModalBtn();

  // Deselect all preset buttons, highlight custom
  document.querySelectorAll('.preset-btn').forEach(b => b.className = 'preset-btn');
  const sub = S.subject || 'nutri';
  document.getElementById('btn-custom-preset').classList.add(sub === 'ecg' ? 'active-ecg' : 'active-nutri');
  document.getElementById('btn-custom-preset').innerHTML =
    '<div class="pb-name">' + mins + 'm</div><div>Custom</div>';

  S.preset = 'custom';
  S.phase  = 'focus';
  S.remaining  = mins * 60;
  S.totalSecs  = mins * 60;

  // auto-select subject if none
  if (!S.subject) {
    S.subject = 'nutri';
    document.getElementById('sc-nutri').className = 'subject-card sel-nutri';
  }

  updateBtnColor();
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();
  toast(`â± Timer ${mins} min impostato!`);
}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEEP MODE + HAPTICS + QUALITY + LOCK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let lastHapticMark = 0;
let confettiArmed = { nutri:true, ecg:true };

function toggleDeepMode() {
  S.deepEnabled = !S.deepEnabled;
  document.getElementById('deep-state').textContent = S.deepEnabled ? 'ON' : 'OFF';
  document.getElementById('deep-toggle').classList.toggle('on', S.deepEnabled);
  toast(S.deepEnabled ? 'Deep Mode pronto ðŸ§ ' : 'Deep Mode disattivato');
  save();
}
function enterDeepModeIfNeeded() {
  if (!S.deepEnabled) return;
  document.body.classList.add('deep-mode');
}
function exitDeepMode() {
  document.body.classList.remove('deep-mode');
}
function softVibrate(ms) {
  try { if (navigator.vibrate) navigator.vibrate(ms); } catch(e){}
}
function handleHaptics() {
  if (!S.running || S.phase !== 'focus') return;
  const elapsedFocus = S.totalSecs - S.remaining;
  const mark = Math.floor(elapsedFocus / (15*60));
  if (mark > lastHapticMark) {
    lastHapticMark = mark;
    softVibrate(20);
  }
}

/* Session tag + energy */
const TAGS = [
  { key:'ripasso', label:'Ripasso' },
  { key:'nuovo', label:'Nuovo argomento' },
  { key:'flash', label:'Flashcard' },
  { key:'casi', label:'Casi clinici' },
];
let pendingSessionIdx = null;
let pendingTag = null;
let pendingEnergy = null;

function openSessionModal(idx) {
  pendingSessionIdx = idx;
  pendingTag = null; pendingEnergy = null;

  const grid = document.getElementById('tag-grid');
  grid.innerHTML = '';
  TAGS.forEach(t => {
    const b = document.createElement('button');
    b.className = 'tag-btn';
    b.textContent = t.label;
    b.onclick = () => {
      pendingTag = t.key;
      grid.querySelectorAll('.tag-btn').forEach(x => x.classList.remove('sel'));
      b.classList.add('sel');
    };
    grid.appendChild(b);
  });

  const row = document.getElementById('energy-row');
  row.innerHTML = '';
  for (let i=1;i<=5;i++){
    const s = document.createElement('div');
    s.className = 'star';
    s.textContent = 'âš¡';
    s.title = String(i);
    s.onclick = () => {
      pendingEnergy = i;
      row.querySelectorAll('.star').forEach(x => x.classList.remove('sel'));
      for (let j=0;j<i;j++) row.children[j].classList.add('sel');
    };
    row.appendChild(s);
  }

  document.getElementById('session-modal').classList.add('open');
}

function closeSessionModal(e){
  if (e && e.target !== document.getElementById('session-modal')) return;
  document.getElementById('session-modal').classList.remove('open');
  pendingSessionIdx = null;
}
function skipSessionTag(){
  closeSessionModal({target: document.getElementById('session-modal')});
  toast('Sessione salvata (senza tag)');
}
function saveSessionTag(){
  if (pendingSessionIdx == null) return closeSessionModal({target: document.getElementById('session-modal')});
  const sess = S.sessions[pendingSessionIdx];
  if (!sess) return closeSessionModal({target: document.getElementById('session-modal')});

  if (pendingTag) sess.studyTag = pendingTag;
  if (pendingEnergy) sess.energy = pendingEnergy;

  save();
  renderStats();
  renderQualityBox();
  closeSessionModal({target: document.getElementById('session-modal')});
  toast('Check-out salvato âœ“');
}

/* Goal Lock */
function openGoalLock(){
  document.getElementById('lock-target').value = (S.goalLock?.targetNutriMin ?? 180);
  document.getElementById('lock-modal').classList.add('open');
}
function closeLockModal(e){
  if (e && e.target !== document.getElementById('lock-modal')) return;
  document.getElementById('lock-modal').classList.remove('open');
}
function enableGoalLock(){
  const target = Number(document.getElementById('lock-target').value || 180);
  S.goalLock = { enabled:true, targetNutriMin: target, createdAt: Date.now(), lastRemindAt: 0 };
  document.getElementById('lock-state').textContent = 'ON';
  document.getElementById('lock-pill').classList.add('on');
  save();
  closeLockModal({target: document.getElementById('lock-modal')});
  toast(`ðŸ”’ Lock attivo: ${target} min Nutrizione`);
}
function disableGoalLock(){
  S.goalLock = null;
  document.getElementById('lock-state').textContent = 'OFF';
  document.getElementById('lock-pill').classList.remove('on');
  save();
  closeLockModal({target: document.getElementById('lock-modal')});
  toast('Lock disattivato');
}
function goalLockActiveAndUnmet(){
  if (!S.goalLock?.enabled) return false;
  const doneMin = Math.floor(S.nutriSecs/60);
  return doneMin < (S.goalLock.targetNutriMin||0);
}
function goalLockReminderTick(){
  if (!S.goalLock?.enabled) return;
  const doneMin = Math.floor(S.nutriSecs/60);
  const target = S.goalLock.targetNutriMin||0;
  if (doneMin >= target) return;
  const nowTs = Date.now();
  if (!S.goalLock.lastRemindAt || (nowTs - S.goalLock.lastRemindAt) > 60*60*1000){
    S.goalLock.lastRemindAt = nowTs;
    softVibrate(30);
    toast(`ðŸ”’ Sotto target: ${doneMin}/${target} min Nutrizione`);
    save();
  }
}

/* Weekly chart + quality box */
function getHistory(){
  try { return JSON.parse(localStorage.getItem(KEY + '_history') || '{}'); } catch(e){ return {}; }
}
function lastNDays(n){
  const out = [];
  const d = new Date();
  for (let i=n-1;i>=0;i--){
    const x = new Date(d); x.setDate(d.getDate()-i);
    out.push(x.toDateString());
  }
  return out;
}
function renderWeeklyChart(){
  const canvas = document.getElementById('week-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const hist = getHistory();
  const days = lastNDays(7);
  const vals = days.map(k => ((hist[k]?.nutriSecs||0) + (hist[k]?.ecgSecs||0)) / 60);
  const max = Math.max(60, ...vals);
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const W = canvas.width, H = canvas.height;
  const pad = 28;
  const bw = (W - pad*2) / vals.length;

  ctx.globalAlpha = 0.8;
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(pad, H-pad);
  ctx.lineTo(W-pad, H-pad);
  ctx.strokeStyle = 'rgba(255,255,255,0.18)';
  ctx.stroke();

  vals.forEach((v,i)=>{
    const h = (H - pad*2) * (v / max);
    const x = pad + i*bw + 6;
    const y = (H - pad) - h;
    ctx.fillStyle = 'rgba(226,234,248,0.35)';
    ctx.fillRect(x, y, bw-12, h);
  });

  const avg = vals.reduce((a,b)=>a+b,0)/vals.length;
  const pctDaysGoal = vals.filter(v=> v >= (GOALS.nutri + GOALS.ecg)).length;
  const note = document.getElementById('week-note');
  if (note) note.textContent = `Media 7g: ${Math.round(avg)} min â€¢ Giorni sopra goal totale: ${pctDaysGoal}/7`;
}
function avgEnergyToday(){
  const arr = (S.sessions||[]).map(s=>s.energy).filter(Boolean);
  if (!arr.length) return 0;
  return arr.reduce((a,b)=>a+b,0)/arr.length;
}
function renderQualityBox(){
  const box = document.getElementById('quality-box');
  if (!box) return;
  const tagged = (S.sessions||[]).filter(s=>s.studyTag || s.energy);
  if (!tagged.length){
    box.innerHTML = '<div class="empty-state">Completa una sessione per iniziare</div>';
    return;
  }
  const tagCounts = {};
  const energyByHour = {};
  tagged.forEach(s=>{
    if (s.studyTag) tagCounts[s.studyTag] = (tagCounts[s.studyTag]||0)+1;
    if (s.energy){
      const h = Number((s.time||'').split(':')[0]) || new Date().getHours();
      const key = String(h).padStart(2,'0');
      energyByHour[key] = energyByHour[key] || [0,0];
      energyByHour[key][0] += s.energy;
      energyByHour[key][1] += 1;
    }
  });
  const tagLines = TAGS.map(t=>{
    const c = tagCounts[t.key]||0;
    return `<div style="display:flex;justify-content:space-between;gap:10px;margin:6px 0">
      <div style="color:var(--muted2);font-size:12px">${t.label}</div>
      <div style="font-family:'DM Mono',monospace">${c}</div>
    </div>`;
  }).join('');
  const bestHour = Object.entries(energyByHour)
    .map(([h,[sum,c]])=>[h, sum/c])
    .sort((a,b)=>b[1]-a[1])[0];
  const bestStr = bestHour ? `${bestHour[0]}:00 (â‰ˆ ${bestHour[1].toFixed(1)}/5)` : 'â€”';
  box.innerHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:start">
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted2);margin-bottom:6px">Distribuzione</div>
        ${tagLines}
      </div>
      <div>
        <div style="font-size:10px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted2);margin-bottom:6px">Energia</div>
        <div style="font-family:'DM Mono',monospace;font-size:28px">${avgEnergyToday().toFixed(1)}</div>
        <div style="color:var(--muted2);font-size:12px;margin-top:2px">media oggi (1â€“5)</div>
        <div style="margin-top:10px;color:var(--muted2);font-size:12px">Miglior orario: <span style="color:var(--text)">${bestStr}</span></div>
      </div>
    </div>`;
}

/* Confetti */
function maybeConfetti(){
  if (confettiArmed.nutri && S.nutriSecs >= GOALS.nutri*60){
    confettiArmed.nutri = false;
    softVibrate(25);
    runConfetti();
  }
  if (confettiArmed.ecg && S.ecgSecs >= GOALS.ecg*60){
    confettiArmed.ecg = false;
    softVibrate(25);
    runConfetti();
  }
}
function runConfetti(){
  const c = document.getElementById('confetti');
  if (!c) return;
  const ctx = c.getContext('2d');
  c.width = window.innerWidth; c.height = window.innerHeight;
  const N = 90;
  const parts = Array.from({length:N}).map(()=>({
    x: Math.random()*c.width,
    y: -20 - Math.random()*c.height*0.2,
    vy: 2 + Math.random()*4,
    vx: -1 + Math.random()*2,
    r: 2 + Math.random()*4,
    a: Math.random()*Math.PI*2,
  }));
  const t0 = Date.now();
  function frame(){
    const t = Date.now()-t0;
    ctx.clearRect(0,0,c.width,c.height);
    ctx.globalAlpha = 0.9;
    parts.forEach(p=>{
      p.x += p.vx; p.y += p.vy; p.a += 0.08;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.a);
      ctx.fillStyle = 'rgba(226,234,248,0.85)';
      ctx.fillRect(-p.r, -p.r, p.r*2, p.r*2);
      ctx.restore();
    });
    if (t < 1200) requestAnimationFrame(frame);
    else ctx.clearRect(0,0,c.width,c.height);
  }
  requestAnimationFrame(frame);
}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

function restoreRuntime() {
  // restore UI toggles
  document.getElementById('deep-state').textContent = S.deepEnabled ? 'ON' : 'OFF';
  document.getElementById('deep-toggle').classList.toggle('on', S.deepEnabled);
  document.getElementById('lock-state').textContent = S.goalLock?.enabled ? 'ON' : 'OFF';
  document.getElementById('lock-pill').classList.toggle('on', !!S.goalLock?.enabled);

  // restore preset selection (no timer start)
  document.querySelectorAll('.preset-btn').forEach(b => {
    b.className = 'preset-btn';
    if (b.dataset.preset === S.preset) {
      const p = PRESETS[S.preset];
      b.classList.add(p.subject==='nutri'?'active-nutri':'active-ecg');
    }
  });

  // restore subject
  if (S.subject) {
    document.getElementById('sc-nutri').className = 'subject-card' + (S.subject==='nutri'?' sel-nutri':'');
    document.getElementById('sc-ecg').className   = 'subject-card' + (S.subject==='ecg'  ?' sel-ecg':'');
  }
  updateBtnColor();
  updatePhaseLabel();
  updateTimerDisplay();
  updateRing();

  // if running, recompute remaining and resume
  if (S.running && tickerStartedAt && typeof tickerBaseRemaining === 'number') {
    const elapsed = Math.floor((Date.now() - tickerStartedAt)/1000);
    const newRemaining = Math.max(0, tickerBaseRemaining - elapsed);
    S.remaining = newRemaining;
    if (S.remaining <= 0) { S.running = false; phaseEnd(); return; }

    document.getElementById('timer-digits').classList.add('live');
    document.getElementById('btn-start').textContent = 'Pausa';
    enterDeepModeIfNeeded();
    ticker = setInterval(tick, 500);
  }
}


function init() {
  load();
  restoreRuntime();
  setInterval(goalLockReminderTick, 60*1000);

  // date
  document.getElementById('hdr-date').textContent =
    new Date().toLocaleDateString('it-IT',{weekday:'long',day:'numeric',month:'long'});
  document.getElementById('streak-badge').textContent = 'ðŸ”¥ '+S.streak+' giorni';

  // set default preset button active
  document.querySelector('[data-preset="nutri45"]').classList.add('active-nutri');

  renderGoalLabels();
  updateProgressUI();
  updateTimerDisplay();
  updatePhaseLabel();
  updateRing();
  buildPomodoDots();
  buildPlan();
  renderTasks();
  renderStats();
  renderSessionLog();

  // Recupera il tempo perso quando l'app torna in primo piano (schermo sbloccato)
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden && S.running && tickerStartedAt) {
      // Il browser era sospeso: ricalcola subito senza aspettare il prossimo tick
      tick();
    }
  });

  // task input enter
  document.getElementById('task-input').addEventListener('keydown', e => {
    if (e.key==='Enter') addTask();
  });

  // request notification permission
  if ('Notification' in window && Notification.permission==='default') {
    Notification.requestPermission();
  }
}

init();

  // Register Service Worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(() => {});
  }
</script>
</body>
</html>
